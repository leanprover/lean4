/-!
# Tests of autogenerated simp congruence theorems
-/

namespace Issue2128
/-!
Simp was failing to use autogenerated congruence theorems for partially applied functions.
-/

opaque partiallyApplied (p : Prop) [Decidable p] : Nat → Nat

example : partiallyApplied (True ∧ True) = partiallyApplied True := by
  simp

end Issue2128

namespace PartialApply1
/-!
Another test along the lines of `Issue2128`. The partially-applied function was not being simplified.
-/

def printProp (p : Prop) [Decidable p] : IO Unit :=
  if p then IO.println "true" else IO.println "false"

example (x y : Nat) (h : x = y) : printProp (x = 1) = printProp (y = 1) := by
  simp [h]

end PartialApply1
